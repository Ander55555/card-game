<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arcane Blitz — Strategic Card Duel</title>
  <style>
    /* Styles unchanged for brevity */
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Arcane Blitz — Strategic Card Duel</h1>
      <div class="muted">Expanded deck • More effects • Strategic turns</div>
    </header>
    <!-- Layout unchanged for brevity -->
  </div>

  <script>
  const DEFAULT_DECK = [
    {"id":"Strike","type":"Attack","power":3,"text":"Deal 3 damage."},
    {"id":"Power Strike","type":"Attack","power":4,"text":"Deal 4 damage. Costs 1 energy.","cost":1},
    {"id":"Guard","type":"Block","block":3,"text":"Negate next 3 damage."},
    {"id":"Fortify","type":"Block","block":5,"text":"Negate next 5 damage. Costs 1 energy.","cost":1},
    {"id":"Heal","type":"Heal","power":3,"text":"Restore 3 life."},
    {"id":"Greater Heal","type":"Heal","power":5,"text":"Restore 5 life. Costs 1 energy.","cost":1},
    {"id":"Adrenaline","type":"Utility","draw":2,"discard":1,"text":"Draw 2 cards, then discard 1."},
    {"id":"Overload","type":"Attack","power":6,"selfDamage":2,"cost":1,"text":"Deal 6 damage. Lose 2 life."},
    {"id":"Riposte","type":"Utility","riposte":true,"text":"Return half of the next damage you take."},
    {"id":"Siphon","type":"Attack","power":2,"healOnDamage":2,"text":"Deal 2 damage and heal for 2."},
    {"id":"Insight","type":"Utility","scry":3,"text":"Look at top 3 cards and pick 1 to add to hand."},
    {"id":"Mana Surge","type":"Utility","gainEnergy":2,"text":"Gain 2 energy this turn."},
    {"id":"Fireball","type":"Attack","power":5,"cost":2,"text":"Deal 5 damage to opponent."},
    {"id":"Ice Shield","type":"Block","block":4,"freeze":true,"text":"Block 4 damage and freeze opponent next turn (skip draw)."},
    {"id":"Poison Dart","type":"Attack","poison":3,"text":"Apply poison: 3 damage at start of each of their turns for 2 turns."},
    {"id":"Cleanse","type":"Utility","cleanse":true,"text":"Remove all debuffs from yourself."},
    {"id":"Double Strike","type":"Attack","multiHit":2,"power":2,"text":"Hit twice for 2 damage each."},
    {"id":"Drain Life","type":"Attack","power":3,"healOnDamage":3,"cost":1,"text":"Deal 3 damage and heal 3."}
  ];

  // Game state now includes energy and debuffs
  let state = {
    deck:[], discard:[], player:{life:20,hand:[],block:0,riposte:false,energy:2,poison:0},
    opp:{life:20,hand:[],block:0,riposte:false,energy:2,poison:0},
    turn:'player', turnNumber:1, ai:true, timer:60
  };

  // Updated resolveCard to handle energy, poison, freeze, cleanse, multiHit, etc.
  function resolveCard(card, me, them){
    if(card.cost && me.energy < card.cost){ appendBattle("Not enough energy!"); return; }
    if(card.cost) me.energy -= card.cost;

    if(card.multiHit){
      for(let i=0;i<card.multiHit;i++) doDamage(card.power, me, them);
    } else if(card.power) {
      doDamage(card.power, me, them);
    }

    if(card.block) me.block += card.block;
    if(card.selfDamage) me.life -= card.selfDamage;
    if(card.type==='Heal' && card.power) me.life += card.power;
    if(card.draw) for(let i=0;i<card.draw;i++) draw(me);
    if(card.discard) for(let i=0;i<card.discard;i++) discardRandom(me);
    if(card.scry) scryCards(card.scry, me);
    if(card.riposte) me.riposte = true;
    if(card.gainEnergy) me.energy += card.gainEnergy;
    if(card.freeze) them.frozen = true;
    if(card.poison) them.poison = {amount:card.poison, turns:2};
    if(card.cleanse) { me.poison=0; me.frozen=false; }
  }

  function doDamage(amount, me, them){
    let effective = Math.max(0, amount - them.block);
    them.block = Math.max(0, them.block - amount);
    if(them.riposte && effective>0){
      let ret = Math.floor(effective/2);
      me.life -= ret;
      them.riposte = false;
    }
    them.life -= effective;
  }

  // Other helper functions updated similarly (draw, discardRandom, scryCards, etc.)

  function startTurn(){
    let current = state.turn==='player'? state.player : state.opp;
    current.energy = 2;
    if(current.poison && current.poison.turns>0){
      current.life -= current.poison.amount;
      current.poison.turns--;
    }
    if(current.frozen){
      current.frozen=false;
      // Skip draw phase
    } else {
      draw(current);
    }
    renderAll();
  }
  </script>
</body>
</html>
